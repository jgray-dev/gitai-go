#!/bin/bash

set -e  # Exit on error

echo "Building gitai..."

# Build the binary
echo "→ Compiling..."
go build -o gitai main.go

# Determine installation directory
INSTALL_DIR="$HOME/.local/bin"

# Create directory if it doesn't exist
mkdir -p "$INSTALL_DIR"

# Move binary to installation directory
echo "→ Installing to $INSTALL_DIR/gitai..."
mv gitai "$INSTALL_DIR/gitai"
chmod +x "$INSTALL_DIR/gitai"

# Check if the directory is in PATH
if [[ ":$PATH:" != *":$INSTALL_DIR:"* ]]; then
    echo ""
    echo "⚠️  Warning: $INSTALL_DIR is not in your PATH"
    echo "   Add this line to your ~/.bashrc or ~/.zshrc:"
    echo "   export PATH=\"\$HOME/.local/bin:\$PATH\""
fi

echo ""
echo "✓ Installation complete!"
echo ""
echo "Run 'gitai' in any git repository with modified files"
